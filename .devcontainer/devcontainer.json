{
  // https://docs.github.com/en/codespaces/setting-up-your-project-for-codespaces/configuring-dev-containers/setting-a-minimum-specification-for-codespace-machines
  "image": "debian:bookworm-slim",
  "features": {
    "ghcr.io/devcontainers/features/nix:1": {}
  },
  "postCreateCommand": "nix-env -iA nixpkgs.direnv && echo 'eval \"$(direnv hook bash)\"' >> ~/.bashrc && direnv allow",
  // avoids https://code.visualstudio.com/docs/sourcecontrol/faq#_why-is-vs-code-warning-me-that-the-git-repository-is-potentially-unsafe (because of nix)
  "postStartCommand": "git config --global --add safe.directory ${containerWorkspaceFolder}",
  "remoteEnv": {
    "DIRENV_LOG_FORMAT": ""
  },
  "mounts": [
    "type=volume,target=/workspaces/${localWorkspaceFolderBasename}/.dart_tool" // anonymous volume
    // "type=volume,source=dart-tool-${localWorkspaceFolderBasename},target=/workspaces/${localWorkspaceFolderBasename}/.dart_tool" // named volume (persists across rebuilds)
  ],
  "customizations": {
		// Configure properties specific to VS Code. See https://containers.dev/supporting#visual-studio-code
		"vscode": {
			// Set *default* container specific settings.json values on container create.
			"settings": {
        "dart.sdkPath": "${env:HOME}/.nix-profile/bin/dart"
      },
			"extensions": [
        "jnoortheen.nix-ide",
        "skellock.just"
        // "dart-code.dart-code" // dart sdk is not ready yet because it's installed with nix-env LATER. Install dart in the `postCreateCommand` to use the extension here, otherwise it's fine in extensions.json
      ]
		}
  }
}